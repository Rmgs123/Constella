services:
  constella:
    build: .
    container_name: constella-node
    restart: always
    env_file: .env
    volumes:
      - ./state:/app/state
      - /sbin/reboot:/sbin/reboot:ro
      - /sbin/shutdown:/sbin/shutdown:ro
      - /sbin/init:/sbin/init:ro
      - /bin/systemctl:/bin/systemctl:ro
    ports:
      - "4747:4747"

    privileged: true        # разрешаем контейнеру доступ к системным вызовам
    pid: "host"             # делим PID-пространство с хостом (позволяет reboot/shutdown)
